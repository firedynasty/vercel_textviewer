{"ast":null,"code":"import _objectSpread from\"/Users/stanleytan/Documents/25-technical/01-github/vercel_textviewer/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import Sidebar from'./components/Sidebar';import ContentViewer from'./components/ContentViewer';import ControlBar from'./components/ControlBar';import{processFiles}from'./utils/fileUtils';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function TextViewer(){const[files,setFiles]=useState([]);const[currentIndex,setCurrentIndex]=useState(0);const[fontSize,setFontSize]=useState(18);const[isEditing,setIsEditing]=useState(false);const[editContent,setEditContent]=useState('');const[imagePathToBlobUrl,setImagePathToBlobUrl]=useState({});const currentFile=files[currentIndex]||null;const handleFilesLoaded=useCallback(fileList=>{const result=processFiles(fileList);if(result.error){alert(result.error);return;}setFiles(result.files);setImagePathToBlobUrl(result.imagePathToBlobUrl||{});setCurrentIndex(0);setIsEditing(false);setEditContent('');},[]);const handleFileSelect=useCallback(index=>{if(isEditing){if(!window.confirm('You have unsaved changes. Discard them?')){return;}}setCurrentIndex(index);setIsEditing(false);setEditContent('');},[isEditing]);const handlePrev=useCallback(()=>{if(files.length===0)return;if(isEditing){if(!window.confirm('You have unsaved changes. Discard them?')){return;}setIsEditing(false);}setCurrentIndex(prev=>prev>0?prev-1:files.length-1);},[files.length,isEditing]);const handleNext=useCallback(()=>{if(files.length===0)return;if(isEditing){if(!window.confirm('You have unsaved changes. Discard them?')){return;}setIsEditing(false);}setCurrentIndex(prev=>prev<files.length-1?prev+1:0);},[files.length,isEditing]);const handleFontSizeChange=useCallback(delta=>{setFontSize(prev=>Math.max(10,Math.min(40,prev+delta)));},[]);const handleEdit=useCallback(()=>{if(!currentFile||currentFile.type!=='text'&&currentFile.type!=='markdown')return;// Fetch current content\nfetch(currentFile.url).then(res=>res.text()).then(text=>{setEditContent(text);setIsEditing(true);}).catch(err=>{console.error('Error loading file for edit:',err);alert('Error loading file for editing');});},[currentFile]);const handleSave=useCallback(()=>{if(!currentFile||!isEditing)return;// Create a new blob with the edited content\nconst blob=new Blob([editContent],{type:'text/plain'});const newUrl=URL.createObjectURL(blob);// Update the file in the array\nsetFiles(prevFiles=>{const newFiles=[...prevFiles];newFiles[currentIndex]=_objectSpread(_objectSpread({},newFiles[currentIndex]),{},{url:newUrl});return newFiles;});// Download the file\nconst a=document.createElement('a');a.href=newUrl;a.download=currentFile.originalName||\"\".concat(currentFile.key,\".txt\");a.click();setIsEditing(false);setEditContent('');},[currentFile,currentIndex,editContent,isEditing]);const handleCancel=useCallback(()=>{setIsEditing(false);setEditContent('');},[]);// Keyboard navigation\nuseEffect(()=>{const handleKeyDown=e=>{// Don't handle keys when editing\nif(isEditing)return;if(e.key==='ArrowLeft'){handlePrev();}else if(e.key==='ArrowRight'){handleNext();}};window.addEventListener('keydown',handleKeyDown);return()=>window.removeEventListener('keydown',handleKeyDown);},[handlePrev,handleNext,isEditing]);// Global drag and drop\nuseEffect(()=>{const handleDragOver=e=>{e.preventDefault();};const handleDrop=e=>{e.preventDefault();};window.addEventListener('dragover',handleDragOver);window.addEventListener('drop',handleDrop);return()=>{window.removeEventListener('dragover',handleDragOver);window.removeEventListener('drop',handleDrop);};},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"text-viewer\",children:[/*#__PURE__*/_jsx(Sidebar,{files:files,currentIndex:currentIndex,onFileSelect:handleFileSelect}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-content\",children:[/*#__PURE__*/_jsx(ControlBar,{currentFile:currentFile,fontSize:fontSize,onFontSizeChange:handleFontSizeChange,isEditing:isEditing,onEdit:handleEdit,onSave:handleSave,onCancel:handleCancel,onFilesLoaded:handleFilesLoaded}),/*#__PURE__*/_jsx(ContentViewer,{file:currentFile,fontSize:fontSize,isEditing:isEditing,editContent:editContent,onEditChange:setEditContent,imagePathToBlobUrl:imagePathToBlobUrl,onPrev:handlePrev,onNext:handleNext})]})]});}export default TextViewer;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Sidebar","ContentViewer","ControlBar","processFiles","jsx","_jsx","jsxs","_jsxs","TextViewer","files","setFiles","currentIndex","setCurrentIndex","fontSize","setFontSize","isEditing","setIsEditing","editContent","setEditContent","imagePathToBlobUrl","setImagePathToBlobUrl","currentFile","handleFilesLoaded","fileList","result","error","alert","handleFileSelect","index","window","confirm","handlePrev","length","prev","handleNext","handleFontSizeChange","delta","Math","max","min","handleEdit","type","fetch","url","then","res","text","catch","err","console","handleSave","blob","Blob","newUrl","URL","createObjectURL","prevFiles","newFiles","_objectSpread","a","document","createElement","href","download","originalName","concat","key","click","handleCancel","handleKeyDown","e","addEventListener","removeEventListener","handleDragOver","preventDefault","handleDrop","className","children","onFileSelect","onFontSizeChange","onEdit","onSave","onCancel","onFilesLoaded","file","onEditChange","onPrev","onNext"],"sources":["/Users/stanleytan/Documents/25-technical/01-github/vercel_textviewer/src/TextViewer.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport Sidebar from './components/Sidebar';\nimport ContentViewer from './components/ContentViewer';\nimport ControlBar from './components/ControlBar';\nimport { processFiles } from './utils/fileUtils';\n\nfunction TextViewer() {\n  const [files, setFiles] = useState([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [fontSize, setFontSize] = useState(18);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editContent, setEditContent] = useState('');\n  const [imagePathToBlobUrl, setImagePathToBlobUrl] = useState({});\n\n  const currentFile = files[currentIndex] || null;\n\n  const handleFilesLoaded = useCallback((fileList) => {\n    const result = processFiles(fileList);\n\n    if (result.error) {\n      alert(result.error);\n      return;\n    }\n\n    setFiles(result.files);\n    setImagePathToBlobUrl(result.imagePathToBlobUrl || {});\n    setCurrentIndex(0);\n    setIsEditing(false);\n    setEditContent('');\n  }, []);\n\n  const handleFileSelect = useCallback((index) => {\n    if (isEditing) {\n      if (!window.confirm('You have unsaved changes. Discard them?')) {\n        return;\n      }\n    }\n    setCurrentIndex(index);\n    setIsEditing(false);\n    setEditContent('');\n  }, [isEditing]);\n\n  const handlePrev = useCallback(() => {\n    if (files.length === 0) return;\n    if (isEditing) {\n      if (!window.confirm('You have unsaved changes. Discard them?')) {\n        return;\n      }\n      setIsEditing(false);\n    }\n    setCurrentIndex((prev) => (prev > 0 ? prev - 1 : files.length - 1));\n  }, [files.length, isEditing]);\n\n  const handleNext = useCallback(() => {\n    if (files.length === 0) return;\n    if (isEditing) {\n      if (!window.confirm('You have unsaved changes. Discard them?')) {\n        return;\n      }\n      setIsEditing(false);\n    }\n    setCurrentIndex((prev) => (prev < files.length - 1 ? prev + 1 : 0));\n  }, [files.length, isEditing]);\n\n  const handleFontSizeChange = useCallback((delta) => {\n    setFontSize((prev) => Math.max(10, Math.min(40, prev + delta)));\n  }, []);\n\n  const handleEdit = useCallback(() => {\n    if (!currentFile || (currentFile.type !== 'text' && currentFile.type !== 'markdown')) return;\n\n    // Fetch current content\n    fetch(currentFile.url)\n      .then(res => res.text())\n      .then(text => {\n        setEditContent(text);\n        setIsEditing(true);\n      })\n      .catch(err => {\n        console.error('Error loading file for edit:', err);\n        alert('Error loading file for editing');\n      });\n  }, [currentFile]);\n\n  const handleSave = useCallback(() => {\n    if (!currentFile || !isEditing) return;\n\n    // Create a new blob with the edited content\n    const blob = new Blob([editContent], { type: 'text/plain' });\n    const newUrl = URL.createObjectURL(blob);\n\n    // Update the file in the array\n    setFiles(prevFiles => {\n      const newFiles = [...prevFiles];\n      newFiles[currentIndex] = {\n        ...newFiles[currentIndex],\n        url: newUrl\n      };\n      return newFiles;\n    });\n\n    // Download the file\n    const a = document.createElement('a');\n    a.href = newUrl;\n    a.download = currentFile.originalName || `${currentFile.key}.txt`;\n    a.click();\n\n    setIsEditing(false);\n    setEditContent('');\n  }, [currentFile, currentIndex, editContent, isEditing]);\n\n  const handleCancel = useCallback(() => {\n    setIsEditing(false);\n    setEditContent('');\n  }, []);\n\n  // Keyboard navigation\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      // Don't handle keys when editing\n      if (isEditing) return;\n\n      if (e.key === 'ArrowLeft') {\n        handlePrev();\n      } else if (e.key === 'ArrowRight') {\n        handleNext();\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [handlePrev, handleNext, isEditing]);\n\n  // Global drag and drop\n  useEffect(() => {\n    const handleDragOver = (e) => {\n      e.preventDefault();\n    };\n\n    const handleDrop = (e) => {\n      e.preventDefault();\n    };\n\n    window.addEventListener('dragover', handleDragOver);\n    window.addEventListener('drop', handleDrop);\n\n    return () => {\n      window.removeEventListener('dragover', handleDragOver);\n      window.removeEventListener('drop', handleDrop);\n    };\n  }, []);\n\n  return (\n    <div className=\"text-viewer\">\n      <Sidebar\n        files={files}\n        currentIndex={currentIndex}\n        onFileSelect={handleFileSelect}\n      />\n\n      <div className=\"main-content\">\n        <ControlBar\n          currentFile={currentFile}\n          fontSize={fontSize}\n          onFontSizeChange={handleFontSizeChange}\n          isEditing={isEditing}\n          onEdit={handleEdit}\n          onSave={handleSave}\n          onCancel={handleCancel}\n          onFilesLoaded={handleFilesLoaded}\n        />\n\n        <ContentViewer\n          file={currentFile}\n          fontSize={fontSize}\n          isEditing={isEditing}\n          editContent={editContent}\n          onEditChange={setEditContent}\n          imagePathToBlobUrl={imagePathToBlobUrl}\n          onPrev={handlePrev}\n          onNext={handleNext}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default TextViewer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}